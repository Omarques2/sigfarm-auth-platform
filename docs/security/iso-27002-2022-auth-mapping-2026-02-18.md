# ISO/IEC 27002:2022 - Authentication Mapping (Internet-validated)

## Sources used
1. ISO official standard page for ISO/IEC 27002:2022 (control guidance standard): https://www.iso.org/standard/75652.html
2. ISO official standard page for ISO/IEC 27001:2022 (Annex A control context): https://www.iso.org/standard/82875.html
3. Secondary references for publicly visible control-family structure and control titles:
   - PECB overview on ISO/IEC 27001:2022 updates: https://pecb.com/article/how-does-isoiec-270012022-differ-from-isoiec-270012013
   - ISMS.online Annex A guide: https://www.isms.online/iso-27001/annex-a-2022/
   - ControlStack control pages: https://www.controlstack.com/iso-27002-controls/5-16-identity-management, https://www.controlstack.com/iso-27002-controls/5-17-authentication-information, https://www.controlstack.com/iso-27002-controls/8-5-secure-authentication

## Important limitation
- The normative ISO text is licensed and not fully public; this mapping uses official ISO metadata plus reputable secondary summaries for control naming.
- User-provided PDF (`docs/nbr_iso_27002.pdf`) is not OCR-searchable in current workspace extraction pipeline, so line-by-line citation from the PDF is not currently possible.

## Technical evidence used from this repo
1. `docs/security/auth-broken-auth-results.json`
2. `docs/security/authentication-assessment-2026-02-18.md`
3. `apps/auth-api/src/auth/better-auth.gateway.ts`
4. `apps/auth-api/src/auth/password-policy.ts`
5. `apps/auth-api/src/index.ts`
6. `apps/auth-api/src/auth/account-flow.service.ts`

## Auth control mapping (ISO/IEC 27002:2022 scope)
| Control | Theme | Status | Repo evidence |
|---|---|---|---|
| 5.15 Access control | Organizational | Implemented | Protected account/session endpoints require auth (`AUTH-003`) |
| 5.16 Identity management | Organizational | Implemented | Verified email lifecycle and account flows (`AUTH-008`, `AUTH-018..020`) |
| 5.17 Authentication information | Organizational | Implemented | Password policy (`min 12`, complexity) at signup/reset (`AUTH-005`, `AUTH-006`) |
| 5.18 Access rights | Organizational | Implemented | Session invalidation on logout/password reset (`AUTH-015`) |
| 8.5 Secure authentication | Technological | Implemented | JWT forgery blocked + refresh token rotation/reuse detection (`AUTH-004`, `AUTH-014`) |
| 8.15 Logging | Technological | Implemented (baseline) | Correlation ID and auth audit events recorded |
| 8.16 Monitoring activities | Technological | Partially implemented | Logging is present, but Azure Monitor alerting still pending |
| 8.24 Use of cryptography | Technological | Implemented (baseline) | Argon2id password hashing, signed JWT, hashed opaque tokens |
| 8.28 Secure coding | Technological | Implemented with residual risk | Security tests passing; no dangerous dynamic execution patterns found |
| 8.31 Separation of environments | Technological | Partially implemented | Dev behavior differs (non-secure cookie flag), prod hardening still required |

## Residual gaps to close for stronger conformity
1. Enable and tune production monitoring/alerts for auth abuse patterns (failed sign-in spikes, reset-code abuse, bounce anomalies).
2. Enforce HTTPS and verify `Secure` cookies in staging/prod evidence checklist.
3. Continue dependency lifecycle hardening (`npm audit` shows moderate transitives in auth-api toolchain).
4. Produce OCR/searchable ISO PDF (or licensed control text excerpts) for formal traceability package.

## Conclusion
- Based on internet-validated control structure plus repo evidence, auth implementation is materially aligned with the relevant ISO/IEC 27002:2022 controls.
- Remaining work is mainly operational governance and production runtime controls, not core auth-flow defects.
